<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link href="api.css" type="text/css" rel="stylesheet" title="Standard style for API reference" />
<title>operateAffine - Affine transformation arithmetic composition</title>
</head>
<body>
<h1><span class="fheader"><a name="top" id="top">Layer.operateAffine</a></span></h1><div class="para">
<dl>
<dt>Function/Meaning</dt>
<dd><p>Affine transformation arithmetic composition</p>
</dd>
<dt>Type</dt>
<dd><a class="jump" href="class_Layer.html">Layer class</a> method</dd>
<dt>Syntax</dt>
<dd><span class="funcdecl">operateAffine(<span class="arg">src</span>, <span class="arg">sleft</span>, <span class="arg">stop</span>, <span class="arg">swidth</span>, <span class="arg">sheight</span>, <span class="arg">affine</span>, <span class="arg">A</span>, <span class="arg">B</span>, <span class="arg">C</span>, <span class="arg">D</span>, <span class="arg">E</span>, <span class="arg">F</span>, <span class="arg">mode</span><span class="defarg">=<span class="defargval">omAuto</span></span>, <span class="arg">opa</span><span class="defarg">=<span class="defargval">255</span></span>, <span class="arg">type</span><span class="defarg">=<span class="defargval">stNearest</span></span>)</span></dd>
<dt>Arguments</dt>
<dd><table rules="all" frame="box" cellpadding="3" summary="operateAffine arguments">
<tr><td valign="top"><span class="argname">src</span></td>
<td><p>Specifies the source layer object.<br />
Bitmap class objects can also be specified.</p>
</td></tr>
<tr><td valign="top"><span class="argname">sleft</span></td>
<td><p>Specifies the left edge position of the rectangle to be overlaid in pixels (relative to the source layer's image position).</p>
</td></tr>
<tr><td valign="top"><span class="argname">stop</span></td>
<td><p>Specifies the top edge position of the rectangle to be overlaid in pixels (relative to the source layer's image position).</p>
</td></tr>
<tr><td valign="top"><span class="argname">swidth</span></td>
<td><p>Specifies the width of the rectangle to be overlaid in pixels (relative to the source layer's image position).</p>
</td></tr>
<tr><td valign="top"><span class="argname">sheight</span></td>
<td><p>Specifies the height of the rectangle to be overlaid in pixels (relative to the source layer's image position).</p>
</td></tr>
<tr><td valign="top"><span class="argname">affine</span></td>
<td><p>Specifies how to handle the following six arguments (parameters A to F).<br />
If true is specified, the six parameters are interpreted as follows:</p>

<ul>
<li>A   : a of the 2D affine transformation matrix</li>
<li>B   : b of the 2D affine transformation matrix</li>
<li>C   : c of the 2D affine transformation matrix</li>
<li>D   : d of the 2D affine transformation matrix</li>
<li>E   : tx of the 2D affine transformation matrix</li>
<li>F   : ty of the 2D affine transformation matrix</li>
</ul>

<p>By affine transformation, the source image position (x, y) (where the top-left corner of the source rectangle is (0, 0)) is converted to the destination image position (x', y') by the following formula:<br />
x' =  a*x + c*y + tx<br />
y' =  b*x + d*y + ty<br />
If false is specified, the six parameters are interpreted as follows:</p>

<ul>
<li>A   : X-coordinate position (x0) of the top-left corner of the source rectangle at the destination image position</li>
<li>B   : Y-coordinate position (y0) of the top-left corner of the source rectangle at the destination image position</li>
<li>C   : X-coordinate position (x1) of the top-right corner of the source rectangle at the destination image position</li>
<li>D   : Y-coordinate position (y1) of the top-right corner of the source rectangle at the destination image position</li>
<li>E   : X-coordinate position (x2) of the bottom-left corner of the source rectangle at the destination image position</li>
<li>F   : Y-coordinate position (y2) of the bottom-left corner of the source rectangle at the destination image position</li>
</ul>

<p>If false is specified, the destination position (x3, y3) corresponding to the bottom-right corner of the source is automatically calculated by the following formula:<br />
x3 = x1 - x0 + x2<br />
y3 = y1 - y0 + y2</p>
</td></tr>
<tr><td valign="top"><span class="argname">A</span></td>
<td><p>Parameter A.<br />
Interpretation changes depending on the affine argument.</p>
</td></tr>
<tr><td valign="top"><span class="argname">B</span></td>
<td><p>Parameter B.<br />
Interpretation changes depending on the affine argument.</p>
</td></tr>
<tr><td valign="top"><span class="argname">C</span></td>
<td><p>Parameter C.<br />
Interpretation changes depending on the affine argument.</p>
</td></tr>
<tr><td valign="top"><span class="argname">D</span></td>
<td><p>Parameter D.<br />
Interpretation changes depending on the affine argument.</p>
</td></tr>
<tr><td valign="top"><span class="argname">E</span></td>
<td><p>Parameter E.<br />
Interpretation changes depending on the affine argument.</p>
</td></tr>
<tr><td valign="top"><span class="argname">F</span></td>
<td><p>Parameter F.<br />
Interpretation changes depending on the affine argument.</p>
</td></tr>
<tr><td valign="top"><span class="argname">mode</span></td>
<td><p>Specifies the arithmetic mode.</p>

<ul>
<li>If omAuto is specified, the type of operation is automatically determined according to the Layer.type property of the source layer.</li>
<li>If omPsNormal is specified, Photoshop-compatible alpha blending is performed (not implemented in the current version).</li>
<li>If omPsAdditive is specified, Photoshop-compatible linear dodge blending is performed (not implemented in the current version).</li>
<li>If omPsSubtractive is specified, Photoshop-compatible linear burn blending is performed (not implemented in the current version).</li>
<li>If omPsMultiplicative is specified, Photoshop-compatible multiplicative blending is performed (not implemented in the current version).</li>
<li>If omPsScreen is specified, Photoshop-compatible screen blending is performed (not implemented in the current version).</li>
<li>If omPsOverlay is specified, Photoshop-compatible overlay blending is performed (not implemented in the current version).</li>
<li>If omPsHardLight is specified, Photoshop-compatible hard light blending is performed (not implemented in the current version).</li>
<li>If omPsSoftLight is specified, Photoshop-compatible soft light blending is performed (not implemented in the current version).</li>
<li>If omPsColorDodge is specified, Photoshop-compatible color dodge blending is performed (not implemented in the current version).</li>
<li>If omPsColorDodge5 is specified, color dodge blending compatible with Photoshop version 5.x or lower is performed (not implemented in the current version).</li>
<li>If omPsColorBurn is specified, Photoshop-compatible color burn blending is performed (not implemented in the current version).</li>
<li>If omPsLighten is specified, Photoshop-compatible lighten blending is performed (not implemented in the current version).</li>
<li>If omPsDarken is specified, Photoshop-compatible darken blending is performed (not implemented in the current version).</li>
<li>If omPsDifference is specified, Photoshop-compatible difference blending is performed (not implemented in the current version).</li>
<li>If omPsDifference5 is specified, difference blending compatible with Photoshop version 5.x or lower is performed (not implemented in the current version).</li>
<li>If omPsExclusion is specified, Photoshop-compatible exclusion blending is performed (not implemented in the current version).</li>
<li>If omAdditive is specified, additive blending is performed (not implemented in the current version).</li>
<li>If omSubtractive is specified, subtractive blending is performed (not implemented in the current version).</li>
<li>If omMultiplicative is specified, multiplicative blending is performed (not implemented in the current version).</li>
<li>If omDodge is specified, dodge blending is performed (not implemented in the current version).</li>
<li>If omDarken is specified, darken blending is performed (not implemented in the current version).</li>
<li>If omLighten is specified, lighten blending is performed (not implemented in the current version).</li>
<li>If omScreen is specified, screen multiplicative blending is performed (not implemented in the current version).</li>
<li>If omAlpha is specified, alpha blending is performed.</li>
<li>If omAddAlpha is specified, additive alpha blending is performed. In this case, when the destination Layer.face property is dfOpaque and the Layer.holdAlpha property is false, linear interpolation is possible by specifying stFastLinear for the type argument.</li>
<li>If omOpaque is specified, the alpha information of src is ignored, and src is always considered completely opaque. In this case, when the destination Layer.face property is dfOpaque and the Layer.holdAlpha property is false, linear interpolation is possible by specifying stFastLinear for the type argument.</li>
</ul>
</td></tr>
<tr><td valign="top"><span class="argname">opa</span></td>
<td><p>Specifies the opacity of the overlay (0 to 255).</p>
</td></tr>
<tr><td valign="top"><span class="argname">type</span></td>
<td><p>Specifies the type of affine transformation.</p>

<ul>
<li>stNearest     : Nearest neighbor method is used</li>
<li>stFastLinear  : Low-precision linear interpolation is used (partially implemented)</li>
<li>stLinear      : Linear interpolation is used (not implemented)</li>
<li>stCubic       : Cubic interpolation is used (not implemented)</li>
</ul>

<p>Speed is faster in the order of stNearest > stFastLinear > stLinear > stCubic, but the image quality is lower for faster modes.<br />
stRefNoClip can be additionally specified using a bitwise OR; in this case, referencing outside the bitmap area to be copied for color blending is allowed.<br />
If this is not specified, even if there is margin around the source bitmap, it will not reference outside the source bitmap range (colors outside the range are considered the color of the nearest pixel within the range).</p>
</td></tr>
</table></dd>
<dt>Return Value</dt>
<dd>None (void)</dd>
<dt>Description</dt>
<dd><p>Performs arithmetic composition while applying an affine transformation to the specified source layer rectangle onto the destination (the layer executing the method).<br />
See also Layer.affineCopy for information on affine transformations.<br />
If omAuto is specified